<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Csquares objects • csquares</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Csquares objects">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">csquares</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.7</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/csquares-objects.html">Csquares objects</a>
    </li>
    <li>
      <a href="../articles/ices.html">ICES rectangles</a>
    </li>
    <li>
      <a href="../articles/tidy.html">Tidy csquares</a>
    </li>
    <li>
      <a href="../articles/Wildcards.html">Wildcards</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/pepijn-devries/csquares/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><link href="csquares-objects_files/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="csquares-objects_files/htmlwidgets-1.6.4/htmlwidgets.js"></script><script src="csquares-objects_files/viz-1.8.2/viz.js"></script><link href="csquares-objects_files/DiagrammeR-styles-0.2/styles.css" rel="stylesheet">
<script src="csquares-objects_files/grViz-binding-1.0.11/grViz.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Csquares objects</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/pepijn-devries/csquares/blob/main/vignettes/csquares-objects.Rmd" class="external-link"><code>vignettes/csquares-objects.Rmd</code></a></small>
      <div class="hidden name"><code>csquares-objects.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://pepijn-devries.github.io/csquares/" class="external-link">csquares</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="the-s3-class-csquares">The S3 class <code>csquares</code><a class="anchor" aria-label="anchor" href="#the-s3-class-csquares"></a>
</h2>
<p>The csquares package has defined a <code>csquares</code> class.
Objects that are of this class contain a <code>character</code> vector
or is a <code>character</code> vector itself, where the characters
represent valid <a href="https://en.wikipedia.org/wiki/C-squares" class="external-link">csquares</a> codes. The
advantage to have a distinct class for these objects is that you
automatically inherit all methods that are available for parent classes.
The <code>csquares</code> object can essentially inherit from the
following classes (arranged from simplest to most complex):</p>
<ul>
<li>
<code>character</code> vectors;</li>
<li>
<code>data.frame</code>;</li>
<li>spatial classes:
<ul>
<li>sf (<code><a href="https://r-spatial.github.io/sf/reference/sf.html" class="external-link">sf::st_sf()</a></code>);</li>
<li>stars (<code><a href="https://r-spatial.github.io/stars/reference/st_as_stars.html" class="external-link">stars::st_as_stars()</a></code>).</li>
</ul>
</li>
</ul>
<p>It is important to realise that <code>csquare</code> objects can have
varying parents, which is visualised in the diagram below. What you can
do with <code>csquares</code> objects in part depends on its parent.
Let’s start with showing how <code>csqaures</code> objects are created
and how they will inherit properties from the different parents listed
above.</p>
<div class="grViz html-widget html-fill-item" id="htmlwidget-ac96cb3ee4656e2e9ec3" style="width:700px;height:432.632880098888px;"></div>
<script type="application/json" data-for="htmlwidget-ac96cb3ee4656e2e9ec3">{"x":{"diagram":"\ndigraph \"Csquares schematic\" {\nlayout = \"dot\";\nsplines = spline;\nnode [fontname = Helvetica shape = box style = filled fillcolor = white class = \"csquare_nodes\"];\n\ncsquares   [label = \"csquares\" fillcolor = palegreen];\nstrucstrs  [label = \"{<stars>stars::stars|<starscsq>csquares}\" URL=\"#using-spatiotemporal-arrays-stars\" shape = record];\n\nsubgraph cluster_dfc {\nstyle = filled;\nfontname = Helvetica;\nfillcolor = lightcyan;\nlabel = \"data.frame csquare\";\nstrucdf    [label = \"{<df>data.frame|<dfcsq>csquares}\" URL=\"#using-data-frames\" shape = record];\nstrucsf    [label = \"{<sf>sf::sf|<sfcsq>csquares}\" URL=\"#using-simple-features-sf\" shape = record];\n}\nsubgraph cluster_char {\nstyle = filled;\nfontname = Helvetica;\nfillcolor = lightcyan;\nlabel = \"character csquare\";\nstrucchar  [label = \"{<character>character|<charcsq>csquares}\" URL=\"#using-characters\" shape = record];\nvctr       [label = \"vctrs::vctrs_vctr\"];\n}\n\nvctr -> strucchar:character\nstrucchar:charcsq  -> csquares;\nstrucdf:dfcsq      -> csquares;\nstrucsf:sfcsq      -> csquares;\nstrucstrs:starscsq -> csquares;\nstrucdf:df -> strucsf:sf;\nstrucchar:charcsq -> strucdf:dfcsq;\nstrucchar:charcsq -> strucsf:sfcsq;\n}\n","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="section level2">
<h2 id="creating-csquares-objects">Creating <code>csquares</code> objects<a class="anchor" aria-label="anchor" href="#creating-csquares-objects"></a>
</h2>
<div class="section level3">
<h3 id="using-characters">Using characters<a class="anchor" aria-label="anchor" href="#using-characters"></a>
</h3>
<p>The simplest way of creating a <code>csquares</code> object is by
coercing other objects with <code><a href="../reference/as_csquares.html">as_csquares()</a></code>. The example
below shows how to create a <code>csquares</code> object from a vector
of <code>characters</code>:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">csquares_char</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/as_csquares.html">as_csquares</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1000"</span>, <span class="st">"3000"</span>, <span class="st">"5000"</span>, <span class="st">"7000"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="using-data-frames">Using data.frames<a class="anchor" aria-label="anchor" href="#using-data-frames"></a>
</h3>
<p>Perhaps a more useful format is a <code>data.frame</code>, as you can
add data associated with the spatial squares. You can cast the previous
object to a <code>data.frame</code> and it will automatically inherit
the <code>csquares</code> class:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">csquares_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">csquares_char</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">csquares_df</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "csquares"   "data.frame"</span></span></code></pre></div>
<p>This means that you can apply all operations that you could apply to
a normal <code>data.frame</code>. This includes <a href="https://www.tidyverse.org" class="external-link">tidyverse</a> operations as explained
in more detail in <code><a href="../articles/tidy.html">vignette("tidy")</a></code>. For example, you can
add columns with data:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">csquares_df</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">csquares_df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>dummy <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span></span></code></pre></div>
<p>You can also cast a plain <code>data.frame</code> to a csquares
object. In that case, your <code>data.frame</code> should already
contain a column with csquares codes. All you have to do is specify
which column this is:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">orca_csq</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/as_csquares.html">as_csquares</a></span><span class="op">(</span><span class="va">orca</span>, csquares <span class="op">=</span> <span class="st">"csquares"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="using-simple-features-sf">Using Simple Features (sf)<a class="anchor" aria-label="anchor" href="#using-simple-features-sf"></a>
</h3>
<p>Remember that csquares encode geographic rectangles, so it makes
sense to include this spatial information in the
<code>data.frame</code>. This is achieved by coercing a
<code>csquares</code> <code>data.frame</code> to a simple features
(<code>sf</code>) object. It too will automatically inherit the
<code>csquares</code> class:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span></span>
<span><span class="va">csquares_sf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/st_as_sf.html">st_as_sf</a></span><span class="op">(</span><span class="va">csquares_df</span><span class="op">)</span></span></code></pre></div>
<p>The object <code>csquares_sf</code> now has a column holding the
csquares codes and a column containing the corresponding geometric
features. Both should represent the same spatial object. But be careful!
Not all methods are aware of this, so modifying the geometric column
might break this association.</p>
</div>
<div class="section level3">
<h3 id="using-spatiotemporal-arrays-stars">Using Spatiotemporal Arrays (stars)<a class="anchor" aria-label="anchor" href="#using-spatiotemporal-arrays-stars"></a>
</h3>
<p><code>csquares</code> objects inheriting from the <code>stars</code>
are a little trickier. This is because there are more constraints: You
cannot include just any csquares at any location with varying
resolutions. At the moment <code>csquares</code> only support regular
linear grids where each grid cell size is the same as that of the
associated csquares. To create a <code>csquares</code>
<code>stars</code> object, you have to provide a bounding box and a
resolution in degrees:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/stars/" class="external-link">stars</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">csquares_stars</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/new_csquares.html">new_csquares</a></span><span class="op">(</span><span class="va">csquares_sf</span>, resolution <span class="op">=</span> <span class="fl">10L</span><span class="op">)</span></span></code></pre></div>
<p>Even though we use the <code>csquares_sf</code> object to create the
grid, it doesn’t include any of the columns from the <code>sf</code>
object in the resulting <code>stars</code> object. That is because only
the bounding box of <code>csquares_sf</code> is used to create
<code>csquares_stars</code>. You can add information to the grid by
matching the csquares codes:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## create an empty column:</span></span>
<span><span class="va">csquares_stars</span><span class="op">[[</span><span class="st">"dummy"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span><span class="va">csquares_stars</span><span class="op">[[</span><span class="st">"dummy"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">csquares_df</span><span class="op">[[</span><span class="st">"dummy"</span><span class="op">]</span><span class="op">]</span> <span class="op">[</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/match.html" class="external-link">match</a></span><span class="op">(</span><span class="va">csquares_stars</span><span class="op">[[</span><span class="st">"csquares"</span><span class="op">]</span><span class="op">]</span>, <span class="va">csquares_df</span><span class="op">[[</span><span class="st">"csquares"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="op">]</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="validating-csquares-objects">Validating <code>csquares</code> objects<a class="anchor" aria-label="anchor" href="#validating-csquares-objects"></a>
</h2>
<p>When creating a csquares object with <code>as_csquares</code>, it is
not allowed to pass illegal codes, or codes with wildcards (see
<code>vignette("wildcards")</code>). It will throw an error. You could
try to work around this and create a fake <code>csquares</code> object
by assigning the class manually to an illegal code. However, if you test
its validity you will see that it is not going to fly:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Let's create a fake csquares object with a code that is merely impossible:</span></span>
<span><span class="va">fake_csquares</span> <span class="op">&lt;-</span> <span class="st">"1099"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">fake_csquares</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"csquares"</span></span>
<span></span>
<span><span class="co">## Of course this isn't valid</span></span>
<span><span class="fu"><a href="../reference/validate_csquares.html">validate_csquares</a></span><span class="op">(</span><span class="va">fake_csquares</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] FALSE</span></span>
<span></span>
<span><span class="co">## This one is:</span></span>
<span><span class="fu"><a href="../reference/validate_csquares.html">validate_csquares</a></span><span class="op">(</span><span class="va">csquares_char</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Pepijn de Vries.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer>
</div>






  </body>
</html>
